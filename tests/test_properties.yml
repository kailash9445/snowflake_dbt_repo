
version: 2
mmodels:
  - name: my_model
    columns:
      - name: delivery_status
        tests:
          - accepted_values:
              values: ['delivered', 'pending', 'failed']
mmodels:
  - name : "kailash.sql"
    config:
      materialized: 'table'
      hours_to_expiration: 168
      persist_docs:
      mmodels:
        tags: ['naresh','kamaleshwar']
    columns:
      - name: eno
        tests:
          - unique:
            column_name: eno
            config:
              where: "order_date = current_date" 
          - not_null
          - dbt_utils.expression_is_true:
## expression: "order_items_subtotal = subtotal"-
          
                
      - name: dpno
        tests:
          - accepted_values:
              values: ['blue', 'red']
              config:
                severity: warn
                snowflake_warehouse: my_warehouse
          - accepted_values:
              values: [10,20]
              description: "This test checks whether there are unexpected delivery statuses. If it fails, check with logistics team"
      - name: dpno
        tests:
          - relationships:
              to: ref('customers')
              field: id
        tests:
          project_dev:
            +severity: warn
  - name: orders
    columns:
      - name: order_id
        tests:
          - kailash
  
# it is accepting anything above chek later..tests-kailash


              
              
              
              
              
mmodels:
  - name: kailash
    description: "how to product retails"
    columns:
      - name: dpno
        tests:
      - dbt_utils.expression_is_true:
        expression: "dpno"
        where : “retail _price IS NOT NULL”
# till now working
  - name: util_even_numbers
    columns:
      - name: i
        tests:
          - dbt_utils.sequential_values:
              interval: 2
  - name: model_name
    tests:
      - dbt_utils.recency:
          datepart: day
          field: created_at
          interval: 4
          # it will chek 4 days old date 
    tests:
      <resource-path>:
        +fail_calc: <string>
        +limit: <integer>
        +severity: error | warn
        +error_if: <string>
        +warn_if: <string>
        +store_failures: true | false
        +where: <string>

  
    
